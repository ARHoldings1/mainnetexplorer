<%- include('partials/header', {title: 'Transfer 3DOT'}) %>

<main class="container">
    <div class="auth-container">
        <h2>Transfer 3DOT</h2>
        <form id="transferForm" class="auth-form">
            <div class="form-group">
                <label for="toAddress">To Address:</label>
                <input type="text" id="toAddress" placeholder="Recipient Address" required>
            </div>
            <div class="form-group">
                <label for="amount">Amount (3DOT):</label>
                <input type="number" id="amount" placeholder="Amount to send" step="0.000000000000000001" required>
            </div>
            <button type="submit" class="btn">Transfer 3DOT</button>
        </form>
        <div id="transferResult" class="result-message"></div>
    </div>
</main>

<%- include('partials/footer') %>

<script src="https://cdn.jsdelivr.net/npm/web3@1.5.2/dist/web3.min.js"></script>
<script>
document.getElementById('transferForm').addEventListener('submit', async (e) => {
    e.preventDefault();
    const to = document.getElementById('toAddress').value;
    const amount = document.getElementById('amount').value;
    const resultDiv = document.getElementById('transferResult');
    
    try {
        const response = await fetch('/transfer', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ to, amount })
        });
        const result = await response.json();
        if (result.success) {
            resultDiv.textContent = `Transfer successful. Transaction hash: ${result.transaction.transactionHash}`;
            resultDiv.className = 'result-message success';
        } else {
            resultDiv.textContent = `Transfer failed: ${result.error}`;
            resultDiv.className = 'result-message error';
        }
    } catch (error) {
        resultDiv.textContent = `Error: ${error.message}`;
        resultDiv.className = 'result-message error';
    }
});
</script>
